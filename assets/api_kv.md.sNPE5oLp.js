import{_ as t,c as a,ag as s,o as i}from"./chunks/framework.qSHG2lgv.js";const c=JSON.parse('{"title":"ðŸª£ KV","description":"","frontmatter":{},"headers":[],"relativePath":"api/kv.md","filePath":"api/kv.md"}'),n={name:"api/kv.md"};function o(h,e,r,l,d,k){return i(),a("div",null,e[0]||(e[0]=[s('<h1 id="ðŸª£-kv" tabindex="-1">ðŸª£ KV <a class="header-anchor" href="#ðŸª£-kv" aria-label="Permalink to &quot;ðŸª£ KV&quot;">â€‹</a></h1><p>As described in <a href="/dev-docs/functions/data_storage.html">Storing data</a>, Jstz smart functions store data in a persistent key-value database. This database is built directly into the Jstz runtime, available using the global <code>Kv</code> object. Smart functions can read only their own data, not the data of other smart functions. Therefore, it is not necessary to worry about name collisions for keys with other smart functions. Other clients can read the data, but only a smart function can write to the keys it puts in the database.</p><p>Data is stored as a persistent collection of key-value pairs, much like the properties of a JavaScript object or a Map object. The keys are strings and the values are serializable JavaScript objects. Keys are unique within the database, and the last value to be set is the one that is returned when next reading the key.</p><p>As described in <a href="/dev-docs/functions/data_storage.html#errors">Errors</a> operations on the database are synchronous and atomic, committed only if the request to the smart function succeeds. If a smart function writes to storage and throws an uncaught error later in the same transaction, the changes to the database are reversed and the storage is set to what it was before the request that failed.</p><p>To create a key-value pair and store data, pass the key and the value to the <code>Kv.set</code> function, as in this example:</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Kv.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;foo&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { bar: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;baz&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> });</span></span></code></pre></div><p>To read it, pass the key to the <code>Kv.get()</code> function:</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Kv.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;foo&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stringify</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(data)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// { &quot;bar&quot;: &quot;baz&quot; }</span></span></code></pre></div><p>You can also delete a key-value pair using <code>Kv.delete()</code>.</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Kv.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">delete</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;foo&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><p>For more examples, see <a href="/dev-docs/functions/data_storage.html">Storing data</a>.</p><h2 id="instance-methods" tabindex="-1">Instance Methods <a class="header-anchor" href="#instance-methods" aria-label="Permalink to &quot;Instance Methods&quot;">â€‹</a></h2><h3 id="kv-set-key-string-value-unknown-void" tabindex="-1"><code>Kv.set(key: string, value: unknown): void</code> <a class="header-anchor" href="#kv-set-key-string-value-unknown-void" aria-label="Permalink to &quot;`Kv.set(key: string, value: unknown): void`&quot;">â€‹</a></h3><p>Set the value for the given key in the database. If a value already exists for the key, it will be overwritten.</p><h3 id="kv-get-t-unknown-key-string-t-null" tabindex="-1"><code>Kv.get&lt;T = unknown&gt;(key: string): T | null</code> <a class="header-anchor" href="#kv-get-t-unknown-key-string-t-null" aria-label="Permalink to &quot;`Kv.get&lt;T = unknown&gt;(key: string): T | null`&quot;">â€‹</a></h3><p>Retrieve the value for the given key from the database. If no value exists for the key, this function returns <code>null</code>.</p><h3 id="kv-delete-key-string-void" tabindex="-1"><code>Kv.delete(key: string): void</code> <a class="header-anchor" href="#kv-delete-key-string-void" aria-label="Permalink to &quot;`Kv.delete(key: string): void`&quot;">â€‹</a></h3><p>Deletes the value for the given key from the database. If no value exists for the key, this function is a no-op.</p><h3 id="kv-has-key-string-boolean" tabindex="-1"><code>Kv.has(key: string): boolean</code> <a class="header-anchor" href="#kv-has-key-string-boolean" aria-label="Permalink to &quot;`Kv.has(key: string): boolean`&quot;">â€‹</a></h3><p>Returns <code>true</code> if a value exists for the given key in the database, <code>false</code> otherwise.</p>',20)]))}const u=t(n,[["render",o]]);export{c as __pageData,u as default};
